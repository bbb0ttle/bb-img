class BBImg extends HTMLElement{static get observedAttributes(){return["src"]}constructor(){super(),this.observer=null,this.img=null,this.isLoaded=!1,this.attachShadow({mode:"open"})}connectedCallback(){this.render(),this.setupLazyLoading()}disconnectedCallback(){this.observer&&(this.observer.disconnect(),this.observer=null)}attributeChangedCallback(e,t,s){"src"===e&&t!==s&&this.isConnected&&this.updateImage()}render(){this.shadowRoot.innerHTML='\n      <style>\n        :host {\n          display: block;\n          position: relative;\n          width: 100%;\n        }\n        .container {\n          position: relative;\n          width: 100%;\n          aspect-ratio: 2/3;\n          background-color: #d3d3d3;\n          overflow: hidden;\n        }\n        .container.loaded {\n          background-color: transparent;\n        }\n        img {\n          width: 100%;\n          height: 100%;\n          object-fit: cover;\n          opacity: 0;\n          transition: opacity 0.3s ease-in-out;\n        }\n        img.loaded {\n          opacity: 1;\n        }\n      </style>\n      <div class="container">\n        <img />\n      </div>\n    ',this.img=this.shadowRoot.querySelector("img")}setupLazyLoading(){"IntersectionObserver"in window?(this.observer=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&!this.isLoaded&&(this.loadImage(),this.observer&&this.observer.disconnect())})},{rootMargin:"50px"}),this.observer.observe(this)):this.loadImage()}loadImage(){const e=this.getAttribute("src");e&&this.img&&(this.isLoaded=!0,this.img.onload=()=>{this.img.classList.add("loaded");const e=this.shadowRoot.querySelector(".container");e&&e.classList.add("loaded")},this.img.onerror=()=>{console.error(`Failed to load image: ${e}`)},this.img.src=e)}updateImage(){if(this.isLoaded=!1,this.img){this.img.classList.remove("loaded");const e=this.shadowRoot.querySelector(".container");e&&e.classList.remove("loaded")}this.loadImage()}}customElements.define("bb-img",BBImg);export{BBImg};